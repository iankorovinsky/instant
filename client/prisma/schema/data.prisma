// Market Data Models

enum instrument_type {
  bill
  note
  bond
  tips
}

enum yield_tenor {
  M1
  M3
  M6
  Y1
  Y2
  Y3
  Y5
  Y7
  Y10
  Y20
  Y30
}

model Instrument {
  cusip             String   @id @unique
  name              String
  ticker            String?
  type              instrument_type
  coupon            Decimal  @db.Decimal(10, 4)
  issueDate         DateTime
  maturityDate      DateTime
  couponFrequency   Int
  askModifiedDuration    Decimal  @db.Decimal(12, 9)
  bidModifiedDuration    Decimal  @db.Decimal(12, 9)
  askYieldToMaturity     Decimal  @db.Decimal(10, 8)
  askPrice               Decimal  @db.Decimal(10, 4)
  maturityType           String
  issuedAmount           BigInt
  outstandingAmount      BigInt
  currency               String
  
  // Optional fields
  standardPoorRating   String?
  moodyRating            String?
  fitchRating            String?
  dbrsRating             String?
  series                 String?
  bloombergCompositeRating String?
  announce               String?
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  executions Execution[]

  orders Order[]
  positions Position[]

  @@map("instruments")
}

model YieldCurve {
  id         String   @id @default(uuid())
  asOfDate   DateTime
  tenor      yield_tenor
  parYield   Decimal  @db.Decimal(10, 8)
  ingestedAt DateTime @default(now())

  @@unique([asOfDate, tenor])
  @@map("yield_curves")
  @@index([asOfDate])
}
